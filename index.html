<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSYT PAINFUL1 Test</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: #0a0a12;
            color: white;
            font-family: Kanit, sans-serif;
        }
    </style>
</head>

<body class="p-6">

    <h1 class="text-3xl font-bold mb-6">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏Ñ‡∏•‡∏ô</h1>

    <div class="space-y-4 max-w-xl">

        <!-- Roblox Name -->
        <input id="roblox-name"
            class="w-full p-3 rounded bg-black border border-gray-700"
            placeholder="‡∏ä‡∏∑‡πà‡∏≠ Roblox (@xxx)">

        <!-- Bounty -->
        <input id="bounty"
            class="w-full p-3 rounded bg-black border border-gray-700"
            placeholder="Bounty">

        <!-- ‚≠ê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà -->
        <input id="test-wins"
            type="number"
            min="0"
            class="w-full p-3 rounded bg-black border border-gray-700"
            placeholder="‡πÄ‡∏ó‡∏™‡∏ä‡∏ô‡∏∞‡∏Å‡∏µ‡πà‡∏£‡∏≠‡∏ö (‡πÄ‡∏ä‡πà‡∏ô 5)">

        <!-- Sliders -->
        <div id="sliders"></div>

        <div class="text-xl font-bold">
            ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° :
            <span id="total">0</span> / 100
        </div>

        <button onclick="handleSubmit(event)"
            class="w-full p-4 bg-red-600 rounded font-bold">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
        </button>

    </div>


<script>

    // ================= DISCORD CONFIG =================

    const DISCORD_WEBHOOK =
        "https://discord.com/api/webhooks/1470701672174190675/7sZp7dNpq0gJ3un7TY8w6-zVCsohiZ7YNoH9iW6J8D9aompqsREkdfvlGE5LiskRzEhE";

    const DISCORD_ROLE_ID = "1439369148529512488";

    const WEBHOOK_COOLDOWN = 10;
    let lastSendTime = 0;


    // ================= CATEGORY CONFIG =================

    const PASS_THRESHOLD = 41;

    const CATEGORIES = [
        { key: "score_ken",         label: "üëÅÔ∏è ‡πÄ‡∏Ñ‡∏ô",         max: 8  },
        { key: "score_observation", label: "üîÆ ‡πÇ‡∏ã‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß",     max: 17 },
        { key: "score_skill",       label: "üéØ ‡∏™‡∏Å‡∏¥‡∏•‡πÅ‡∏°‡πà‡∏ô",     max: 14 },
        { key: "score_survival",    label: "üõ°Ô∏è ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î",   max: 14 },
        { key: "score_resource",    label: "üíé ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡πâ‡∏°",  max: 14 },
        { key: "score_combo",       label: "‚ö° ‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö",        max: 16 },
        { key: "score_decision",    label: "üß† ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",    max: 17 }
    ];


    // ================= BUILD SLIDERS =================

    const slidersDiv = document.getElementById("sliders");

    CATEGORIES.forEach(cat => {

        const wrapper = document.createElement("div");

        wrapper.innerHTML = `
            <label class="block mb-1">
                ${cat.label}
                (<span id="val-${cat.key}">0</span> / ${cat.max})
            </label>

            <input
                type="range"
                min="0"
                max="${cat.max}"
                value="0"
                class="w-full"
                oninput="updateScore('${cat.key}', this.value)"
            >
        `;

        slidersDiv.appendChild(wrapper);
    });


    // ================= SCORE =================

    function updateScore(key, value) {
        document.getElementById("val-" + key).innerText = value;
        updateTotal();
    }

    function updateTotal() {

        let total = 0;

        CATEGORIES.forEach(cat => {
            const value =
                Number(document.getElementById("val-" + cat.key).innerText);
            total += value;
        });

        document.getElementById("total").innerText = total;
    }


    // ================= DISCORD SEND =================

    async function sendToDiscord(record) {

        const now = Date.now();

        if (now - lastSendTime < WEBHOOK_COOLDOWN * 1000) return;

        lastSendTime = now;

        try {

            await fetch(DISCORD_WEBHOOK, {
                method: "POST",
                headers: { "Content-Type": "application/json" },

                body: JSON.stringify({

                    content: `<@&${DISCORD_ROLE_ID}>`,

                    embeds: [{
                        title: "üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏Ñ‡∏•‡∏ô",

                        color: record.passed ? 0x00ff88 : 0xff2d55,

                        fields: [

                            { name: "üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô", value: record.roblox_name, inline: true },
                            { name: "üí∞ Bounty", value: record.bounty, inline: true },

                            // ‚≠ê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                            { name: "üèÜ ‡∏ä‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏™", value: record.test_wins + " ‡∏£‡∏≠‡∏ö", inline: true },

                            { name: "üéØ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°", value: record.total + " / 100" },

                            { name: "üëÅÔ∏è ‡πÄ‡∏Ñ‡∏ô", value: String(record.score_ken), inline: true },
                            { name: "üîÆ ‡πÇ‡∏ã‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß", value: String(record.score_observation), inline: true },
                            { name: "üéØ ‡∏™‡∏Å‡∏¥‡∏•", value: String(record.score_skill), inline: true },
                            { name: "üõ°Ô∏è ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î", value: String(record.score_survival), inline: true },
                            { name: "üíé ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á", value: String(record.score_resource), inline: true },
                            { name: "‚ö° ‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö", value: String(record.score_combo), inline: true },
                            { name: "üß† ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à", value: String(record.score_decision), inline: true },

                            {
                                name: "üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå",
                                value: record.passed ? "‚úÖ ‡∏ú‡πà‡∏≤‡∏ô" : "‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô"
                            }

                        ],

                        timestamp: new Date().toISOString()
                    }]

                })
            });

        } catch (err) {
            console.log(err);
        }
    }


    // ================= SUBMIT =================

    function handleSubmit(e) {

        e.preventDefault();

        const name =
            document.getElementById("roblox-name").value.trim();

        const bounty =
            document.getElementById("bounty").value.trim();

        const testWins =
            document.getElementById("test-wins").value || 0;

        if (!name || !bounty) {
            alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô");
            return;
        }

        let total = 0;
        let scores = {};

        CATEGORIES.forEach(cat => {

            const value =
                Number(document.getElementById("val-" + cat.key).innerText);

            scores[cat.key] = value;
            total += value;
        });

        const record = {
            roblox_name: name,
            bounty: bounty,
            test_wins: testWins,
            total: total,
            passed: total >= PASS_THRESHOLD,
            ...scores
        };

        sendToDiscord(record);

        alert("‚úÖ ‡∏™‡πà‡∏á Discord ‡πÅ‡∏•‡πâ‡∏ß");
    }

</script>

</body>
</html>